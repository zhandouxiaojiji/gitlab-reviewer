# ä»£ç å®¡æŸ¥åŠŸèƒ½å®ç°è¯´æ˜

## åŠŸèƒ½æ¦‚è¿°

å·²æˆåŠŸå®ç°è¿æ¥çœŸå®GitLab APIçš„ä»£ç å®¡æŸ¥åŠŸèƒ½ï¼Œæ”¯æŒæ˜¾ç¤ºmasteråˆ†æ”¯çš„æäº¤è®°å½•å’ŒreviewçŠ¶æ€ã€‚

## ğŸ¯ å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½

### 1. åç«¯GitLab APIé›†æˆ
- **ä½ç½®**: `server/src/routes/gitlab.ts`
- **åŠŸèƒ½**: è¿æ¥çœŸå®GitLab APIè·å–æäº¤è®°å½•å’Œè¯„è®ºæ•°æ®
- **æ¥å£**:
  - `GET /api/gitlab/projects/:projectId/commits` - è·å–é¡¹ç›®æäº¤è®°å½•
  - `GET /api/gitlab/projects/:projectId/commits/:commitId/comments` - è·å–æäº¤è¯„è®º

### 2. å‰ç«¯CodeReviewç»„ä»¶
- **ä½ç½®**: `client/src/components/CodeReview.tsx`
- **åŠŸèƒ½**: å±•ç¤ºæäº¤è®°å½•ï¼Œæ˜¾ç¤ºreviewçŠ¶æ€
- **ç‰¹æ€§**:
  - é¡¹ç›®é€‰æ‹©ä¸‹æ‹‰æ¡†
  - æäº¤è®°å½•è¡¨æ ¼æ˜¾ç¤º
  - ReviewçŠ¶æ€æ ‡ç­¾ï¼ˆå·²Review/å¾…Reviewï¼‰
  - æ”¯æŒè·³è½¬åˆ°GitLabæŸ¥çœ‹è¯¦æƒ…

### 3. è·¯ç”±é›†æˆ
- **å‰ç«¯è·¯ç”±**: `/code-review?user=username`
- **èœå•é¡¹**: ä¸»å¸ƒå±€ä¸­æ–°å¢"ä»£ç å®¡æŸ¥"èœå•
- **å…¼å®¹æ€§**: å®Œå…¨å…¼å®¹ç°æœ‰URLå‚æ•°ç»“æ„

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### GitLab APIè°ƒç”¨
```typescript
// è·å–æäº¤è®°å½•
const commitsUrl = `${gitlabUrl}/api/v4/projects/${encodedPath}/repository/commits`;
const response = await fetch(commitsUrl, {
  headers: { 'PRIVATE-TOKEN': accessToken }
});
```

### ReviewçŠ¶æ€åˆ¤æ–­
- é€šè¿‡GitLab APIè·å–æ¯ä¸ªcommitçš„è¯„è®ºæ•°é‡
- `hasComments: true` = å·²Review
- `hasComments: false` = å¾…Review

### æ•°æ®ç»“æ„
```typescript
interface Commit {
  id: string;
  message: string;
  author_name: string;
  author_email: string;
  created_at: string;
  web_url: string;
  short_id: string;
  hasComments: boolean;
  commentsCount: number;
}
```

## ğŸ“± ç”¨æˆ·ç•Œé¢

### ä»£ç å®¡æŸ¥é¡µé¢åŒ…å«ï¼š
1. **é¡¹ç›®é€‰æ‹©å™¨** - é€‰æ‹©è¦æŸ¥çœ‹çš„GitLabé¡¹ç›®
2. **åˆ·æ–°æŒ‰é’®** - é‡æ–°è·å–æœ€æ–°æ•°æ®
3. **æäº¤è®°å½•è¡¨æ ¼**:
   - æäº¤IDï¼ˆå¯ç‚¹å‡»è·³è½¬åˆ°GitLabï¼‰
   - æäº¤ä¿¡æ¯
   - ä½œè€…
   - æäº¤æ—¶é—´
   - ReviewçŠ¶æ€ï¼ˆç»¿è‰²=å·²Reviewï¼Œæ©™è‰²=å¾…Reviewï¼‰

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨æœåŠ¡
```bash
# åç«¯æœåŠ¡ï¼ˆç«¯å£3001ï¼‰
cd server && npm start

# å‰ç«¯æœåŠ¡ï¼ˆç«¯å£3000ï¼‰
cd client && npm start
```

### è®¿é—®ä»£ç å®¡æŸ¥åŠŸèƒ½
1. æ‰“å¼€ http://localhost:3000
2. ä½¿ç”¨ä»»æ„ç”¨æˆ·åç™»å½•
3. åœ¨è®¾ç½®é¡µé¢é…ç½®GitLabé¡¹ç›®ï¼ˆåŒ…æ‹¬GitLab URLå’Œè®¿é—®tokenï¼‰
4. ç‚¹å‡»"ä»£ç å®¡æŸ¥"èœå•é¡¹
5. é€‰æ‹©é¡¹ç›®æŸ¥çœ‹æäº¤è®°å½•å’ŒreviewçŠ¶æ€

## ğŸ“‹ åŠŸèƒ½ç‰¹ç‚¹

âœ… **çœŸå®æ•°æ®è¿æ¥** - ç›´æ¥ä»GitLab APIè·å–æ•°æ®  
âœ… **å®æ—¶æ›´æ–°** - æ”¯æŒæ‰‹åŠ¨åˆ·æ–°è·å–æœ€æ–°çŠ¶æ€  
âœ… **çŠ¶æ€æ˜¾ç¤º** - æ¸…æ™°æ˜¾ç¤ºæ¯ä¸ªæäº¤çš„reviewçŠ¶æ€  
âœ… **ç”¨æˆ·å‹å¥½** - ç°ä»£åŒ–UIè®¾è®¡ï¼Œæ“ä½œç®€ä¾¿  
âœ… **å…¼å®¹æ€§** - å®Œå…¨å…¼å®¹ç°æœ‰ç³»ç»Ÿæ¶æ„  
âœ… **å®‰å…¨æ€§** - æ”¯æŒtokenè®¤è¯è®¿é—®GitLab  

## ğŸ”— ç›¸å…³æ–‡ä»¶

### åç«¯æ–‡ä»¶
- `server/src/routes/gitlab.ts` - GitLab APIè·¯ç”±
- `server/src/index.ts` - æ³¨å†ŒGitLabè·¯ç”±

### å‰ç«¯æ–‡ä»¶
- `client/src/components/CodeReview.tsx` - ä»£ç å®¡æŸ¥ç»„ä»¶
- `client/src/components/MainLayout.tsx` - æ·»åŠ èœå•é¡¹
- `client/src/App.tsx` - æ·»åŠ è·¯ç”±

### æµ‹è¯•æ–‡ä»¶
- `test-code-review-with-auth.js` - APIåŠŸèƒ½æµ‹è¯•è„šæœ¬

## ğŸ’¡ åç»­ä¼˜åŒ–å»ºè®®

1. **åˆ†é¡µæ”¯æŒ** - å¯¹äºå¤§é‡æäº¤è®°å½•çš„é¡¹ç›®
2. **ç­›é€‰åŠŸèƒ½** - æŒ‰ä½œè€…ã€æ—¶é—´èŒƒå›´ã€reviewçŠ¶æ€ç­›é€‰
3. **æ‰¹é‡æ“ä½œ** - æ”¯æŒæ‰¹é‡æ ‡è®°reviewçŠ¶æ€
4. **é€šçŸ¥åŠŸèƒ½** - å¾…reviewæäº¤çš„æé†’
5. **ç»Ÿè®¡æŠ¥è¡¨** - reviewå®Œæˆç‡ç»Ÿè®¡å›¾è¡¨ 